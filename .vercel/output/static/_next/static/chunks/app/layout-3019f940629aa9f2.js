(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{9821:function(e,t,s){Promise.resolve().then(s.t.bind(s,7960,23)),Promise.resolve().then(s.bind(s,4389))},4389:function(e,t,s){"use strict";s.d(t,{default:function(){return r}});var n=s(7437),a=s(2265);function r(){let[e,t]=(0,a.useState)(!1),[s,r]=(0,a.useState)([]),[o,i]=(0,a.useState)(""),[l,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),h=(0,a.useRef)(null);async function x(e){if(e.preventDefault(),!o.trim()||l)return;let t=[...s,{role:"user",content:o.trim()}];r(t),i(""),c(!0);try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:t})}),s=(await e.json()).reply||"No response.";r(e=>[...e,{role:"assistant",content:s}])}catch(e){r(e=>[...e,{role:"assistant",content:"⚠️ Error: Unable to reach chat service."}])}finally{c(!1)}}async function b(){let e=s.findLast(e=>"user"===e.role),t=s.findLast(e=>"assistant"===e.role);if(!e||!t)return alert("No Q&A pair to save.");u(!0);try{let s=await fetch("/api/kb-update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.content,answer:t.content})}),n=await s.json();if(n.ok)r(e=>[...e,{role:"assistant",content:"✅ Added to Knowledge Base (total entries: ".concat(n.count,").")}]);else throw Error(n.error||"Save failed")}catch(e){r(t=>[...t,{role:"assistant",content:"❌ Error saving: ".concat(e.message)}])}finally{u(!1)}}return(0,a.useEffect)(()=>{h.current&&h.current.scrollIntoView({behavior:"smooth"})},[s]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>t(!e),className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg w-14 h-14 flex items-center justify-center text-2xl transition-all z-[9999]",style:{fontWeight:"bold",position:"fixed"},title:e?"Close chat":"Chat with Uprise Assistant",children:"\uD83D\uDCAC"}),e&&(0,n.jsxs)("div",{className:"fixed bottom-[90px] right-6 z-[9999] w-[360px] sm:w-[380px] bg-white border border-gray-200 rounded-xl shadow-2xl flex flex-col overflow-hidden",style:{maxHeight:"70vh",position:"fixed"},children:[(0,n.jsxs)("div",{className:"flex items-center justify-between bg-blue-600 text-white px-4 py-2",children:[(0,n.jsx)("h2",{className:"text-sm font-semibold",children:"Uprise Chat Assistant"}),(0,n.jsx)("button",{onClick:()=>t(!1),className:"text-white hover:text-gray-100 text-xl leading-none",children:"\xd7"})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto px-3 py-2 space-y-2",style:{maxHeight:"50vh"},children:[0===s.length&&(0,n.jsx)("div",{className:"text-gray-500 text-sm text-center mt-4",children:"\uD83D\uDC4B Hi! How can I help with your RFP?"}),s.map((e,t)=>(0,n.jsx)("div",{className:"p-2 rounded-lg text-sm whitespace-pre-wrap ".concat("user"===e.role?"bg-blue-50 text-right border border-blue-100":"bg-gray-50 text-left border border-gray-100"),children:e.content},t)),(0,n.jsx)("div",{ref:h})]}),s.some(e=>"assistant"===e.role)&&(0,n.jsx)("button",{onClick:b,disabled:d,className:"mx-3 mb-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg py-1.5 px-3 transition disabled:opacity-50",children:d?"Saving...":"\uD83D\uDCBE Save to Knowledge Base"}),(0,n.jsxs)("form",{onSubmit:x,className:"flex border-t border-gray-200",children:[(0,n.jsx)("input",{type:"text",value:o,onChange:e=>i(e.target.value),placeholder:l?"Thinking...":"Type your message...",disabled:l,className:"flex-1 p-2 text-sm focus:outline-none"}),(0,n.jsx)("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium hover:bg-blue-700 disabled:opacity-50",children:"Send"})]})]})]})}},7960:function(){}},function(e){e.O(0,[587,971,117,744],function(){return e(e.s=9821)}),_N_E=e.O()}]);