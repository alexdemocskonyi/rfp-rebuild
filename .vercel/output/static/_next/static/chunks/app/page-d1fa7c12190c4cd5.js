(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4627:function(e,t,n){Promise.resolve().then(n.bind(n,7340))},7340:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(7437),a=n(2265),o=n(4389);function i(){let[e,t]=(0,a.useState)(null),[n,i]=(0,a.useState)(!1),[s,l]=(0,a.useState)(null);async function d(){if(!e)return l("Please select a file first."),!1;let t=new FormData;t.append("file",e),l("\uD83D\uDCE4 Uploading and ingesting file...");try{let e=await fetch("/api/ingest",{method:"POST",body:t}),n=await e.json();if(n.ok)return l("✅ Ingested ".concat(n.total||"some"," entries into Knowledge Base.")),!0;if(n.skipped)return l("⚠️ Skipped ingest — ".concat(n.reason)),!0;throw Error(n.error||"Unknown ingest failure")}catch(e){return l("❌ Ingest error: ".concat(e.message)),!1}}async function c(){if(!e){l("Please select a file first.");return}if(i(!0),l("⚙️ Ingesting before report generation…"),!await d()){i(!1);return}l("\uD83E\uDDE0 Generating RFP Report...");try{let t=new FormData;t.append("file",e);let n=await fetch("/api/generate-report",{method:"POST",body:t});if(!n.ok)throw Error("HTTP ".concat(n.status));let r=await n.blob(),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download="RFP_Report_".concat(Date.now(),".docx"),o.click(),URL.revokeObjectURL(a),l("✅ Report generated successfully.")}catch(e){l("❌ Report generation failed: ".concat(e.message))}finally{i(!1)}}return(0,r.jsxs)("main",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center",padding:"60px 20px",minHeight:"100vh",background:"#f8f9fa",gap:"40px"},children:[(0,r.jsxs)("div",{style:{maxWidth:420,textAlign:"center"},children:[(0,r.jsx)("h1",{style:{fontSize:"1.8rem",fontWeight:700},children:"\uD83D\uDCC4 UPRISE RFP Tool"}),(0,r.jsx)("p",{style:{color:"#555",marginBottom:"1rem"},children:"Upload a document — we’ll ingest it automatically before generating your report."}),(0,r.jsx)("input",{type:"file",onChange:e=>{var n;return t((null===(n=e.target.files)||void 0===n?void 0:n[0])||null)},style:{border:"1px solid #ccc",borderRadius:"6px",padding:"8px",background:"#fff",width:"100%"}}),(0,r.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"15px",justifyContent:"center"},children:[(0,r.jsx)("button",{onClick:d,disabled:n||!e,style:{background:"#28a745",color:"#fff",border:"none",padding:"10px 18px",borderRadius:"6px",cursor:n?"wait":"pointer",fontWeight:600},children:"Ingest to Knowledge Base"}),(0,r.jsx)("button",{onClick:c,disabled:n||!e,style:{background:"#007bff",color:"#fff",border:"none",padding:"10px 18px",borderRadius:"6px",cursor:n?"wait":"pointer",fontWeight:600},children:n?"Processing...":"Generate RFP Report"})]}),s&&(0,r.jsx)("div",{style:{marginTop:"20px",background:"#fff",padding:"10px 20px",borderRadius:"6px",boxShadow:"0 1px 4px rgba(0,0,0,0.1)",color:s.startsWith("❌")?"red":"#333",minHeight:"50px",whiteSpace:"pre-line"},children:s})]}),(0,r.jsx)("div",{style:{width:"400px",maxHeight:"600px",background:"#fff",borderRadius:"12px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",overflow:"hidden",flexShrink:0},children:(0,r.jsx)(o.default,{})})]})}},4389:function(e,t,n){"use strict";n.d(t,{default:function(){return o}});var r=n(7437),a=n(2265);function o(){let[e,t]=(0,a.useState)(!1),[n,o]=(0,a.useState)([]),[i,s]=(0,a.useState)(""),[l,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),f=(0,a.useRef)(null);async function p(e){if(e.preventDefault(),!i.trim()||l)return;let t=[...n,{role:"user",content:i.trim()}];o(t),s(""),d(!0);try{let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:t})}),n=(await e.json()).reply||"No response.";o(e=>[...e,{role:"assistant",content:n}])}catch(e){o(e=>[...e,{role:"assistant",content:"⚠️ Error: Unable to reach chat service."}])}finally{d(!1)}}async function x(){let e=n.findLast(e=>"user"===e.role),t=n.findLast(e=>"assistant"===e.role);if(!e||!t)return alert("No Q&A pair to save.");u(!0);try{let n=await fetch("/api/kb-update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.content,answer:t.content})}),r=await n.json();if(r.ok)o(e=>[...e,{role:"assistant",content:"✅ Added to Knowledge Base (total entries: ".concat(r.count,").")}]);else throw Error(r.error||"Save failed")}catch(e){o(t=>[...t,{role:"assistant",content:"❌ Error saving: ".concat(e.message)}])}finally{u(!1)}}return(0,a.useEffect)(()=>{f.current&&f.current.scrollIntoView({behavior:"smooth"})},[n]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>t(!e),className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg w-14 h-14 flex items-center justify-center text-2xl transition-all z-[9999]",style:{fontWeight:"bold",position:"fixed"},title:e?"Close chat":"Chat with Uprise Assistant",children:"\uD83D\uDCAC"}),e&&(0,r.jsxs)("div",{className:"fixed bottom-[90px] right-6 z-[9999] w-[360px] sm:w-[380px] bg-white border border-gray-200 rounded-xl shadow-2xl flex flex-col overflow-hidden",style:{maxHeight:"70vh",position:"fixed"},children:[(0,r.jsxs)("div",{className:"flex items-center justify-between bg-blue-600 text-white px-4 py-2",children:[(0,r.jsx)("h2",{className:"text-sm font-semibold",children:"Uprise Chat Assistant"}),(0,r.jsx)("button",{onClick:()=>t(!1),className:"text-white hover:text-gray-100 text-xl leading-none",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto px-3 py-2 space-y-2",style:{maxHeight:"50vh"},children:[0===n.length&&(0,r.jsx)("div",{className:"text-gray-500 text-sm text-center mt-4",children:"\uD83D\uDC4B Hi! How can I help with your RFP?"}),n.map((e,t)=>(0,r.jsx)("div",{className:"p-2 rounded-lg text-sm whitespace-pre-wrap ".concat("user"===e.role?"bg-blue-50 text-right border border-blue-100":"bg-gray-50 text-left border border-gray-100"),children:e.content},t)),(0,r.jsx)("div",{ref:f})]}),n.some(e=>"assistant"===e.role)&&(0,r.jsx)("button",{onClick:x,disabled:c,className:"mx-3 mb-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg py-1.5 px-3 transition disabled:opacity-50",children:c?"Saving...":"\uD83D\uDCBE Save to Knowledge Base"}),(0,r.jsxs)("form",{onSubmit:p,className:"flex border-t border-gray-200",children:[(0,r.jsx)("input",{type:"text",value:i,onChange:e=>s(e.target.value),placeholder:l?"Thinking...":"Type your message...",disabled:l,className:"flex-1 p-2 text-sm focus:outline-none"}),(0,r.jsx)("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-blue-600 text-white text-sm font-medium hover:bg-blue-700 disabled:opacity-50",children:"Send"})]})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4627)}),_N_E=e.O()}]);